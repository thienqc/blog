site_name: thienqc
site_description: thienqc's blog | Chia sẻ trải nghiệm sống, suy tư, và nhiều điều khác...
site_url: https://thienqc.github.io/blog/
site_author: thienqc
copyright: Copyright &copy; 2026 thienqc

theme:
    name: material
    custom_dir: overrides
    icon:
      logo: fontawesome/solid/brain
    favicon: assets/meta/favicon.svg
    # Sử dụng font system fallback để tránh chặn render
    font:
        text: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'JetBrains Mono', monospace
        code: 'JetBrains Mono', Monaco, 'Courier New', monospace
    language: en
    static_templates:
      - 404.html
      - rss.xml
    palette:
      - media: "(prefers-color-scheme)"
        toggle:
          icon: material/link
          name: Switch to light mode
      - media: "(prefers-color-scheme: light)"
        scheme: default
        primary: indigo
        accent: indigo
        toggle:
          icon: material/toggle-switch
          name: Switch to dark mode
      - media: "(prefers-color-scheme: dark)"
        scheme: slate
        primary: black
        accent: indigo
        toggle:
          icon: material/toggle-switch-off
          name: Switch to system preference
    # Giảm features để tối ưu performance
    features:
      - navigation.tracking
      - navigation.sections
      - content.code.copy
      # Tắt search suggestions nếu không cần
      # - search.suggest
      - search.highlight
      # Tắt footer navigation để giảm JS
      # - navigation.footer

plugins:
  - search
  - autolinks
  - callouts
  - minify:
      minify_html: true
      minify_js: true
      minify_css: true
  - blogging:
      dirs:
        - post
      template: overrides/custom-blog.html
      features:
        tags:
          index_page: tags.md
          insert: bottom
      time_format: ' %d-%m-%Y '

markdown_extensions:
  - admonition
  - pymdownx.details
  - pymdownx.superfences
  - footnotes
  - tables
  # Tắt các extensions ít dùng để giảm JS
  # - pymdownx.critic
  # - pymdownx.caret
  # - pymdownx.keys
  # - pymdownx.mark
  # - pymdownx.tilde
  - def_list
  - pymdownx.tasklist:
      custom_checkbox: true
  - pymdownx.highlight:
      anchor_linenums: true
      line_spans: __span
      pygments_lang_class: true
  - pymdownx.inlinehilite
  # - pymdownx.snippets
  - toc:
      permalink: true

# Tối ưu CSS - giảm blocking
extra_css:
  - assets/styles/justify.min.css  # Đảm bảo đã minified

# Tối ưu JS - defer tất cả
extra_javascript:
  - assets/js/random-post.js?defer  # Thêm defer qua parameter

extra:
  head:
    # Preconnect và preload critical resources
    - '<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>'
    - '<link rel="preconnect" href="https://giscus.app">'
    - '<link rel="dns-prefetch" href="https://github.com">'
    - '<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" as="style" onload="this.onload=null;this.rel=\'stylesheet\'">'
    - '<noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"></noscript>'
    
    # Inline critical CSS (tạo file critical.css)
    - |
      <style>
        /* Critical CSS - tối thiểu cho LCP */
        article { max-width: 800px; margin: 0 auto; }
        .md-content__inner { padding-top: 1rem; }
        h1 { font-size: 2.5em; margin-bottom: 1rem; }
        .md-typeset h2 { font-size: 1.8em; margin-top: 2rem; }
        /* Thêm style cho nút random post nếu cần */
        #random-post-btn { display: none; } /* Ẩn mặc định, hiện sau khi JS load */
      </style>
    
    # Load Google Fonts async với font-display: swap
    - |
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" media="print" onload="this.media='all'">
      <noscript>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap">
      </noscript>
  
  social:
    - icon: fontawesome/brands/facebook
      link: https://www.facebook.com/yds.thienqc/
    - icon: fontawesome/brands/instagram
      link: https://www.instagram.com/thienqc/
  analytics:
    provider: google
    property: G-WQ6QJ2DK27
    # Thêm async cho GA4
    gtag_config: 
      anonymize_ip: true
    enable_async: true